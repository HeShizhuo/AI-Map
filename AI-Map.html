<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>石家庄学术·伦理·法治 互动地图</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=R5ARQAHVCz4wIU4CNBeFj1K6sbBpzMT5"></script>
    <style>
        html, body {height:100%;margin:0;padding:0;overflow:hidden;font-family:"Microsoft YaHei",sans-serif;}
        #map-container {height:100vh;width:100%;z-index:1;position:relative;}
        
        .floating-panel{
            position:absolute;
            top:20px;
            left:20px;
            z-index:1000;
            background:rgba(255,255,255,0.95);
            border-radius:12px;
            padding:20px;
            width:280px;
            box-shadow:0 4px 20px rgba(0,0,0,0.15);
            border:1px solid #e0e0e0;
        }
        
        .story-panel{
            position:absolute;
            top:50%;
            left:50%;
            transform:translate(-50%,-50%);
            z-index:1000;
            background:white;
            border-radius:12px;
            padding:0;
            width:90%;
            max-width:400px;
            display:none;
            box-shadow:0 8px 30px rgba(0,0,0,0.25);
            border:1px solid #e0e0e0;
        }
        
        .story-panel.active{
            display:block;
            animation:fadeIn 0.3s ease;
        }
        
        .story-header{
            background:linear-gradient(135deg, #4f6df5, #3a56e8);
            color:white;
            padding:20px;
            border-radius:12px 12px 0 0;
            position:relative;
        }
        
        .story-counter{
            position:absolute;
            top:15px;
            right:15px;
            background:rgba(255,255,255,0.2);
            padding:3px 10px;
            border-radius:20px;
            font-size:12px;
        }
        
        .story-content{
            padding:20px;
        }
        
        .story-footer{
            padding:15px 20px;
            border-top:1px solid #f0f0f0;
            display:flex;
            justify-content:space-between;
        }
        
        .btn{
            padding:8px 16px;
            border-radius:6px;
            border:none;
            cursor:pointer;
            font-size:14px;
            transition:all 0.3s;
        }
        
        .btn-prev{
            background:#f5f5f5;
            color:#666;
        }
        
        .btn-prev:hover{
            background:#e8e8e8;
        }
        
        .btn-next{
            background:#4f6df5;
            color:white;
        }
        
        .btn-next:hover{
            background:#3a56e8;
        }
        
        .progress-bar{
            height:4px;
            background:#e0e0e0;
            border-radius:2px;
            margin:10px 0;
            overflow:hidden;
        }
        
        .progress{
            height:100%;
            background:#4f6df5;
            border-radius:2px;
            transition:width 0.3s;
        }
        
        @keyframes fadeIn {
            from {opacity:0; transform:translate(-50%,-45%);}
            to {opacity:1; transform:translate(-50%,-50%);}
        }
        
        .bubble{
            background:white;
            padding:8px 12px;
            border-radius:20px;
            box-shadow:0 2px 10px rgba(0,0,0,0.1);
            border:1px solid #e0e0e0;
            font-size:12px;
            max-width:150px;
            text-align:center;
        }
        /* 新增图片相关样式 */
    #story-image-container {
        transition: all 0.3s ease;
        border: 1px solid #e0e0e0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    #story-image {
        transition: opacity 0.3s;
    }
    
    #story-image.loading {
        opacity: 0.3;
    }
    
    /* 图片加载动画 */
    @keyframes pulse {
        0% { opacity: 0.6; }
        50% { opacity: 0.3; }
        100% { opacity: 0.6; }
    }
    
    .loading-placeholder {
        animation: pulse 1.5s infinite;
        background: #f0f0f0;
        height: 192px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
    }
    </style>
</head>
<body>
<div id="map-container"></div>

<div class="floating-panel">
    <h1 class="text-xl font-bold mb-3 text-gray-800">石家庄文化地图</h1>
    <div class="category-filter mb-4">
        <h2 class="font-semibold mb-2 text-gray-700">筛选维度</h2>
        <div class="space-y-2">
            <label class="flex items-center">
                <input type="checkbox" class="category-checkbox mr-2" value="morality" checked>
                <span class="text-sm">道德文化传承</span>
            </label>
            <label class="flex items-center">
                <input type="checkbox" class="category-checkbox mr-2" value="rule" checked>
                <span class="text-sm">法治建设实践</span>
            </label>
            <label class="flex items-center">
                <input type="checkbox" class="category-checkbox mr-2" value="values" checked>
                <span class="text-sm">核心价值观践行</span>
            </label>
            <label class="flex items-center">
                <input type="checkbox" class="category-checkbox mr-2" value="culture" checked>
                <span class="text-sm">特色文化传承</span>
            </label>
        </div>
    </div>
    <button id="story-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-all flex items-center justify-center mt-4">
        <i class="fa fa-map-signs mr-2"></i> 开启故事线
    </button>
</div>

<div class="story-panel" id="story-panel">
    <div class="story-header">
        <div class="story-counter" id="story-counter">1/8</div>
        <h2 class="text-xl font-bold" id="story-title">河北博物院</h2>
        <div class="progress-bar mt-3">
            <div class="progress" id="story-progress" style="width:12.5%"></div>
        </div>
    </div>
    <div class="story-content">
        <div class="text-gray-700 leading-relaxed" id="story-description">
            河北博物院是河北省最大的综合性博物馆，收藏了大量珍贵文物，展示了河北地区从古至今的灿烂文化。
        </div>
        <!-- 新增图片展示区域 -->
        <div class="mt-3 rounded-lg overflow-hidden" id="story-image-container">
            <img src="" alt="地点图片" class="w-full h-48 object-cover" id="story-image">
        </div>
        <div class="mt-3 text-sm text-gray-500">
            <i class="fa fa-map-marker mr-1"></i>
            <span id="story-address">河北省石家庄市长安区东大街4号</span>
        </div>
    </div>
    <div class="story-footer">
        <button id="prev-story" class="btn btn-prev">
            <i class="fa fa-arrow-left mr-1"></i>上一站
        </button>
        <button id="next-story" class="btn btn-next">
            下一站<i class="fa fa-arrow-right ml-1"></i>
        </button>
    </div>
</div>

<script>
// 石家庄重要文化地点数据
const culturalSites = [
    {
        id: 1,
        name: "河北博物院",
        category: "culture",
        location: {lat: 38.046331, lng: 114.529280},
        address: "河北省石家庄市长安区东大街4号",
        description: "河北博物院不仅是文物宝库，更是一个将民族历史、国家认同和公民教育融于一体的文化场域，是核心价值观从理论走向实践的“国家课堂”。富强、文明、爱国、敬业、和谐、公正​、诚信、友善​。	通过“战国雄风”等展厅，展示中山国等古代高度发达的文明，让观众从历史维度理解“富强”是民族生存的根基，“文明”是连续不断的传承。这种展示激发了民族自豪感和为当代“富强”奋斗的动力。博物院是激发​​爱国​​情怀的核心基地。观众通过了解家乡的辉煌历史，建立与祖国的情感纽带。同时，文物修复师数十年如一日的精心修复，讲解员专业生动的阐释，本身就是​​敬业​​精神的极致体现。博物院​​免费开放​​，打破了经济门槛，确保了公民文化权利的​​公正​​。不同年龄、职业、背景的人们在此平等地汲取知识，构成了一个​​和谐​​的公共文化空间。博物院对历史的严谨考据和真实展示，是对历史和观众的​​诚信​​。志愿者提供的无私讲解服务，工作人员对游客的帮助，体现了人与人之间的​​友善​​。​",
        imageUrl: "https://img95.699pic.com/video_cover/84/94/52/a_2Det9Msa4jk81586849452.JPG",
        storyOrder: 1
    },
    {
        id: 2,
        name: "正定古城",
        category: "culture",
        location: {lat: 38.149706, lng: 114.580523},
        address: "河北省石家庄市正定县",
        description: "正定古城并非一个静止的“博物馆”，而是一个活着的、有机生长的生命体。它生动诠释了如何在对历史文化的保护与活化中，实现核心价值观的当代实践。和谐​、文明、友善​、自由、民主​、敬业、富强​。古城保护不是“封存”，而是让古塔、古寺与现代商业街区、市民生活空间​​和谐​​共处。游客能看到开元寺钟楼与一旁咖啡店的年轻身影相映成趣，这是古今交融的活态​​和谐​​。古城整洁的环境、规范的旅游服务、对文物古迹的精心维护，本身就是社会​​文明​​程度的体现。当地居民开放自家院落成为公益书屋，商家诚信经营，传递着社区的​​友善​​温度。古城作为公共空间，向所有人​​自由​​开放。市民在此休闲，游客在此探访，享有平等的文化权利。古城更新的规划广泛征求民意，体现了社会治理中的​​民主​​参与。	古城修复者恪守“修旧如旧”的原则，是​​敬业​​；将文化资源转化为旅游产业，带动一方经济，是实现区域​​富强​​的经典路径。",
        imageUrl: "https://youimg1.c-ctrip.com/target/tg/052/590/946/399fa82e2d8b461eae51f23587fa93a2.jpg",
        storyOrder: 2
    },
    {
        id: 3,
        name: "西柏坡纪念馆",
        category: "values",
        location: {lat: 38.345907, lng: 113.951210},
        address: "河北省石家庄市平山县西柏坡镇",
        description: "西柏坡是中国共产党解放全中国的“最后一个农村指挥所”，见证了“新中国从这里走来”的历史。这里集中体现了​​艰苦奋斗、谦虚谨慎、不骄不躁​​的革命精神，以及​​团结协作、忠诚为民​​的集体主义价值观。毛泽东同志提出的“两个务必”（务必保持谦虚谨慎、不骄不躁的作风，务必保持艰苦奋斗的作风）在此诞生，成为中国共产党人的核心精神遗产。\n当代传承与转化​​：\n传承​​：西柏坡精神被纳入党员干部教育培训体系，作为廉政教育和初心使命教育的重要基地。社会各界通过参观学习，强化对艰苦奋斗、勤俭节约等品质的认同。\n​​转化​​：在新时代，西柏坡精神转化为攻坚克难、创新发展的动力，例如激励科技工作者、基层干部在乡村振兴、科技创新中保持清醒头脑，增强忧患意识。其精神也融入企业文化建设，强调团队协作与社会责任。",
        imageUrl: "https://gbpxw.oss-cn-beijing.aliyuncs.com/image/2021/06/29/1624957362482604.png",
        storyOrder: 3
    },
    {
        id: 4,
        name: "赵州桥",
        category: "culture",
        location: {lat: 37.728220, lng: 114.775507},
        address: "河北省石家庄市赵县",
        description: "赵州桥不仅是工程技术奇迹，更是工匠精神的极致体现、卓越追求等传统美德的丰碑。然而，其保护与传承正面临严峻挑战。​​历史文化保护与发展的张力：​​赵州桥作为全国重点文物保护单位，受到《文物保护法》的严格保护。但其周边环境的协调性、旅游开发的尺度（如过度商业化）、以及邻近区域经济发展需求与文物保护红线之间的冲突，是持续存在的难题。这考验着地方治理中依法行政、坚守法治底线的智慧。​​涉及对历史遗产的敬畏之心和传承之责。是追求短期经济利益，还是坚守对子孙后代的文化责任，这是一种道德抉择。​​公众文物保护意识有待加强：​​游客的不文明行为（如刻划、攀爬）可能对古桥造成不可逆的损害。这既反映了部分公众法治意识淡薄（对破坏文物行为的违法性认识不足），也体现了社会公德（爱护公共遗产）的缺失。作为青年学生，我们可以成为赵州桥的“青年守护者”，从以下方面贡献力量​​争做文化传承的“解说员”、争做普法宣传的“先锋队”、争做建言献策的“智囊团”。",
        imageUrl: "https://n.sinaimg.cn/sinacn20120/384/w2048h1536/20190407/b965-hvhrcxm7964887.jpg",
        storyOrder: 4
    },
    {
        id: 5,
        name: "石家庄市博物馆",
        category: "culture",
        location: {lat: 38.051884, lng: 114.519327},
        address: "河北省石家庄市桥西区中华大街四中路3号",
        description: "石家庄市博物馆是展示地方历史文化的重要窗口，通过展览展示石家庄的历史文化。",
        imageUrl: "https://youimg1.c-ctrip.com/target/100r0v000000juuel5FC2.jpg",
        storyOrder: 5
    },
    {
        id: 6,
        name: "石家庄解放纪念碑",
        category: "values",
        location: {lat: 38.051774, lng: 114.496068},
        address: "河北省石家庄市长安区中山东路",
        description: "石家庄解放纪念碑是为纪念1947年解放军攻克石家庄（解放战争初期首个攻克的大城市）而设立，象征​​英勇无畏、牺牲奉献、军民同心​​的革命精神。它体现了对国家的忠诚、对人民的担当，以及“敢打硬仗、敢于胜利”的坚定信念。​​当代传承与转化​​：​​传承​​：通过纪念活动、爱国主义教育，强化公众对解放战争历史的认识，弘扬军人保家卫国的牺牲精神。青少年研学活动中常以此为例，培养集体荣誉感与家国情怀。​​转化​​：在和平年代，这种精神转化为应对重大挑战（如抗疫、抗震救灾）的团结协作意识，激励普通人在岗位上恪尽职守、勇于担当。城市发展中也借鉴“攻坚克难”精神，推动老旧城区改造、经济转型等实践。",
        imageUrl: "https://x0.ifengimg.com/ucms/2023_14/4A280239B4E124F1819E9C63253CD235C7A78D88_size165_w1024_h601.jpg",
        storyOrder: 6
    },
    {
        id: 7,
        name: "石家庄烈士陵园",
        category: "values",
        location: {lat: 38.051266, lng: 114.471358},
        address: "河北省石家庄市桥西区",
        description: "作为安葬革命烈士的庄严场所，陵园集中体现了​​忠贞爱国、舍生取义、无私奉献​​的传统美德与革命道德。烈士们为民族独立和人民解放献出生命，是对“忠”“义”最高层次的践行，也彰显了“天下兴亡，匹夫有责”的集体主义价值观。​​当代传承与转化​​：​​传承​​：通过清明祭扫、国家公祭日活动，传承对烈士的敬畏之心，强化民族记忆。学校、军队常在此举行宣誓仪式，培养青年对国家和社会的责任感。​​转化​​：烈士精神转化为当代爱岗敬业、见义勇为的社会风尚。例如，鼓励公民在平凡岗位恪守职责，在危急关头挺身而出；在社会治理中，强调对弱势群体的关怀，延续“为人民服务”的宗旨。",
        imageUrl: "https://ts1.tc.mm.bing.net/th/id/R-C.aa60b7de2ab2443494918b6e6c322685?rik=ZinFdET31CdhUg&riu=http%3a%2f%2fsjz.laixuanmu.com%2fuploads%2f180804%2f1-1PP4115AV45.jpg&ehk=Q1Xr3iP494EuJMfYFoPEPVEgVxYlLlKgpC3V3V42DDo%3d&risl=&pid=ImgRaw&r=0",
        storyOrder: 7
    },
    {
        id: 8,
        name: "河北师范大学",
        category: "morality",
        location: {lat: 38.003326, lng: 114.527675},
        address: "河北省石家庄市裕华区",
        description: "文明、爱国、敬业、诚信、自由​​。​​理论概念的鲜活转化：​​​​文明传承与创新的高地：​​ 大学是传承人类​​文明​​、创造新知识的核心场所。师大通过教育教学、学术研究，直接推动着社会精神文明的进步。爱国与敬业精神的培育：​​ 学校是培养未来建设者和接班人的摇篮。教师的“教书育人”是​​敬业​​，学生的“刻苦学习”是为未来​​敬业​​做准备。而这一切的最终目的，是培养​​爱国​​报国的有用之才。​​诚信与自由的学风：​​ “学高为师，身正为范”的校训精神，要求师生恪守​​诚信​​的学术道德和做人准则。同时，大学提供的学术平台鼓励思想碰撞、探索未知，为追求真理提供了必要的​​自由​​空间。​​日常实践：​​ 价值观融入在课堂的讲授、图书馆的苦读、实验室的探索、社团活动的协作中。一位教授严谨治学是“敬业诚信”，一个学生参军入伍是“爱国”，一场学术辩论是“自由文明”。校园的每一天，都是价值观内化于心、外化于行的过程。",
        imageUrl: "https://img95.699pic.com/photo/50165/8560.jpg_wh860.jpg",
        storyOrder: 8
    },
    {
        id: 9,
        name: "石家庄市中级人民法院",
        category: "morality",
        location: {lat: 38.092961, lng: 114.463603},
        address: "石家庄市新华区北二环西路191号",
        description: " 石家庄中院作为地方国家审判机关，是法治体系运行的核心枢纽，其存在和运作本身就是法治精神最直接的体现。​​公平正义：​​ 这是法院工作的生命线。法院通过依法独立审理刑事、民事、行政等各类案件，惩罚犯罪、保障人权、化解矛盾、调节社会关系，其最终目标就是实现个案和社会的公平正义。庄严的审判庭、法官的法袍、法槌等器物和仪式，都象征着对程序公正和实体公正的追求。​​权利保障：​​ 法院是公民权利救济的“最后一道防线”。当公民、法人的合法权益受到侵害时，可以通过诉讼途径寻求司法保护。法院通过判决、裁定等方式，明确权利义务边界，强制执行生效法律文书，从而切实保障公民的人身权、财产权等各项基本权利。以 ​​《中华人民共和国民法典》​​ 为例，这部“社会生活的百科全书”在法院的司法实践中得到了最生动的诠释和落实。​​实践场景：​​ 法院是《民法典》实施的主力军。例如，在处理涉及​​高空抛物坠物​​的损害赔偿案件时，《民法典》明确了物业服务企业的安全保障责任、可能加害人的补偿责任以及公安机关的调查职责，彻底改变了以往受害人“寻告无门”的困境。​​如何落地生根：​​​​明晰规则：​​ 法院通过具体案件的判决，将《民法典》中关于“禁止从建筑物中抛掷物品”的原则性规定，转化为明确的行为规范和法律责任。让居民清楚地知道高空抛物的违法成本和严重后果。​​权利救济：​​ 当无辜受害者被高空坠物砸伤，法院依据《民法典》的规定，判决相关责任主体承担赔偿，使受害者的损失得到切实弥补，让纸面上的权利变为现实中的利益。​​行为引导：​​ 每一个相关案件的公开审理和判决，都是一次生动的法治公开课。通过媒体报道、案例发布，向社会公众传递“高空抛物不仅是道德失范，更是违法行为”的强烈信号，引导公民自觉约束行为，从源头上预防纠纷发生。​​总结：​​ 石家庄中院通过审理成千上万件诸如婚姻家庭、合同纠纷、侵权责任等《民法典》涵盖的案件，使这部与百姓生活息息相关的法律不再是冰冷的条文，而成为定分止争、维护社会公平正义的活的法律，真正在百姓心中和生活中“落地生根”。",
        imageUrl: "https://pic.baike.soso.com/ugc/baikepic2/3096/20141229163138-1078506251.jpg/300",
        storyOrder: 9
    },
    {
        id: 10,
        name: "石家庄高新技术产业开发区​",
        category: "values",
        location: {lat: 38.042749, lng: 114.628054},
        address: "河北省石家庄市裕华区东部",
        description: "富强、敬业、创新、文明、和谐。​​富强与创新的引擎：​​ 高新区是石家庄乃至河北省推动经济​​富强​​的核心增长极。这里集聚的高新技术企业，通过持续的​​创新​​驱动，将科技成果转化为现实生产力，直接贡献于国家“富强”的目标。​​敬业精神的舞台：​​ 园区内从企业家、科研人员到一线工程师，无数劳动者在各自岗位上精益求精、追求卓越，是​​敬业​​精神的集中展现。他们的奋斗是“富强”得以实现的具体路径。​​文明与和谐的环境：​​ 良好的创新生态、高效的政务服务、优美的园区环境，本身就是一个​​文明​​、​​和谐​​的现代化社区的缩影，体现了物质文明与精神文明的协调发展。​​",
        imageUrl: "https://ts4.tc.mm.bing.net/th/id/OIP-C.F3QBgEv0X07OGbOFoevo1wHaE8?cb=12&rs=1&pid=ImgDetMain&o=7&rm=3",
        storyOrder: 10
    },
    {
        id: 11,
        name: "井陉矿区",
        category: "values",
        location: {lat: 38.070565, lng: 114.068630},
        address: "石家庄市井陉矿区",
        description: "​​环境治理与可持续发展的重任：​​ 历史上粗放式开采造成的生态环境问题（如地质灾害风险、水体和土壤污染、扬尘等）是典型的“负外部性”。治理需要巨额投入和长期努力，涉及《环境保护法》的严格落实。这关乎对当代居民环境权的保障，也关乎对后代子孙的​​代际公正​​（一种深刻的道德责任）。​​产业转型中的社会公平保障：​​​​挑战描述：​​ 资源枯竭后，传统产业工人面临再就业的困境。如何在新兴产业培育中创造公平的就业机会，健全社会保障体系，确保转型过程​​公正​​普惠，避免部分群体被边缘化，是对社会治理能力和分配正义的考验。我们可以成为矿区转型的“青年助力者”，注入创新活力。​​争做生态文明的“实践者”：​​​​行动：​​ 组织或参与植树造林、垃圾清理等环保志愿服务。利用所学知识，开展矿区土壤、水质的小型监测调研，形成报告供社区参考，用实际行动助力家园的生态修复。​​争做产业创新的“播火者”：​​​​行动：​​ 关注并宣传矿区在文旅融合、现代农业等新产业方面的探索。例如，利用新媒体技能帮助本地特色农产品、工业遗产旅游项目进行推广，为家乡的“新名片”贡献青年人的智慧。​​争做社区服务的“暖心人”：​​​​行动：​​ 开展“关爱矿工前辈”志愿服务，通过口述史记录，抢救性保存工业记忆。为矿区留守儿童提供学业辅导和陪伴，参与社区治理，协助组织文化活动，增强社区凝聚力，在转型期营造​​和谐、友善​​的社区氛围。",
        imageUrl: "https://ts1.tc.mm.bing.net/th/id/R-C.82d8c9d3553c413f5aecb1a097d5be8c?rik=AMO65%2bIaYqe4Gg&riu=http%3a%2f%2fn.sinaimg.cn%2fsinacn10%2f532%2fw800h532%2f20181122%2f7e8e-hmhhnqt3495800.jpg&ehk=NAr3MPxKjGGblKgS0yW1aAqcNTRT%2b4aam0E9pzUEKZ4%3d&risl=&pid=ImgRaw&r=0",
        storyOrder: 11
    },
    {
        id: 12,
        name: "石家庄市少年儿童保护教育中心",
        category: "morality",
        location: {lat: 38.113897, lng: 114.477221},
        address: "石家庄市新华区河北省石家庄市新华区南高基大街8号",
        description: "和谐、友善、公正、爱国​。​​和谐与友善的实践：​​ 该中心的核心工作是救助和保护处于困境的未成年人，为这些曾经遭受不幸的儿童提供一个安全、温暖、包容的“新家”。这生动体现了社会成员之间的​​友善​​（工作人员和社会对孩子的关爱）与​​和谐​​（修复孩子身心的创伤，促进其与社会的和谐融合）。这不仅是慈善，更是构建和谐社会的基石性工作。​​公正与平等的保障：​​ 中心确保每一个孩子，无论其出身和遭遇，都享有生存、发展、受保护和参与的权利。这是对社会​​公正​​（给予弱势群体特殊保护，弥补起点不公）和​​平等​​（保障其作为公民的基本权利平等）最实质的践行。​​爱国主义的萌芽：​​ 通过专业的教育和关爱，让孩子们感受到国家的温暖和社会的关怀，从而在他们心中播下感恩、回报社会的种子。这种由切身感受产生的对国家和社会的认同感，是​​爱国​​主义最朴素、最真实的情感基础。",
        imageUrl: "https://news.hueb.edu.cn/__local/6/80/DE/44386D9229AA70DF78AB226904F_01EFF513_F3DC5.png",
        storyOrder: 12
    },
    {
        id: 13,
        name: "石家庄市宪法公园",
        category: "morality",
        location: {lat: 38.009561, lng:114.523794},
        address: "石家庄市裕华区青园街397号",
        description: "宪法公园是一个开放式、大众化的法治文化阵地，其核心功能在于法治宣传教育和法治文化培育，体现的是​​普及、尊崇、信仰​​的法治精神。公平正义与权利保障：​​ 公园通过雕塑、展板、电子屏等形式，生动阐释《宪法》作为国家根本大法所确立的“法律面前人人平等”原则，以及公民的基本权利和义务。它让公众在休闲活动中就能了解自身享有的选举权、被选举权、言论自由、受教育权等权利，以及国家尊重和保障人权的宪法原则，潜移默化地强化公民的权利意识。​​宪法至上：​​ 公园的核心主题是弘扬宪法精神，树立宪法权威。这体现了“依法治国首先是依宪治国”的核心理念，强调一切法律、法规都不得同宪法相抵触，任何组织和个人都必须在宪法和法律范围内活动。",
        imageUrl: "https://pic.cmc.hebtv.com/0/0d91d6cfb98f5b206ac1e752757fc5a9/2023/12/04/400680df449942a2bb6826fcf4d6d0e9.jpg",
        storyOrder: 13
    }
];

let map;
let markers = [];
let currentStoryIndex = 0;

// 初始化地图
function initMap() {
    map = new BMapGL.Map("map-container");
    
    // 设置石家庄为中心点
    const point = new BMapGL.Point(114.5149, 38.0423);
    map.centerAndZoom(point, 12);
    map.enableScrollWheelZoom(true);
    
    // 添加地图控件
    map.addControl(new BMapGL.ZoomControl());
    map.addControl(new BMapGL.ScaleControl());
    
    // 添加标注
    addMarkers();
}

// 添加地图标注
function addMarkers() {
    culturalSites.forEach(site => {
        const point = new BMapGL.Point(site.location.lng, site.location.lat);
        
        const marker = new BMapGL.Marker(point, {
            enableHighAccuracy: true // 启用高精度模式
        });
        
        map.addOverlay(marker);
        
        // 创建信息窗口
        const infoWindow = new BMapGL.InfoWindow(`
            <div style="padding:10px;max-width:250px">
                <h3 style="margin:0 0 8px 0;font-weight:bold;">${site.name}</h3>
                <p style="margin:0 0 5px 0;font-size:13px;">${site.description}</p>
                <p style="margin:0;font-size:12px;color:#666;">${site.address}</p>
            </div>
        `, {width: 280});
        
        marker.addEventListener('click', () => {
            map.openInfoWindow(infoWindow, point);
        });
        
        markers.push(marker);
    });
}

// 故事线功能
const storySites = culturalSites.filter(site => site.storyOrder).sort((a, b) => a.storyOrder - b.storyOrder);

document.getElementById('story-btn').addEventListener('click', function() {
    document.getElementById('story-panel').classList.add('active');
    showStoryPoint(0);
});

document.querySelector('.close-story')?.addEventListener('click', function() {
    document.getElementById('story-panel').classList.remove('active');
});

document.getElementById('prev-story').addEventListener('click', function() {
    if (currentStoryIndex > 0) {
        showStoryPoint(currentStoryIndex - 1);
    }
});

document.getElementById('next-story').addEventListener('click', function() {
    if (currentStoryIndex < storySites.length - 1) {
        showStoryPoint(currentStoryIndex + 1);
    } else {
        // 故事线结束
        document.getElementById('story-panel').classList.remove('active');
        alert('故事线已结束！感谢您了解石家庄的文化地标。');
    }
});

function showStoryPoint(index) {
    currentStoryIndex = index;
    const site = storySites[index];
    
    // 更新内容
    document.getElementById('story-title').textContent = site.name;
    document.getElementById('story-description').textContent = site.description;
    document.getElementById('story-address').textContent = site.address;
    
    // 新增图片加载逻辑
    const imgElement = document.getElementById('story-image');
    if (site.imageUrl) {
        imgElement.src = site.imageUrl;
        imgElement.alt = site.name + "图片";
        document.getElementById('story-image-container').classList.remove('hidden');
    } else {
        document.getElementById('story-image-container').classList.add('hidden');
    }
    
    // 更新故事面板内容
    document.getElementById('story-title').textContent = site.name;
    document.getElementById('story-description').textContent = site.description;
    document.getElementById('story-address').textContent = site.address;
    document.getElementById('story-counter').textContent = `${index + 1}/${storySites.length}`;
    document.getElementById('story-progress').style.width = `${((index + 1) / storySites.length) * 100}%`;
    
    // 更新按钮状态
    document.getElementById('prev-story').disabled = index === 0;
    document.getElementById('next-story').textContent = index === storySites.length - 1 ? '完成' : '下一站';
    
    // 移动地图到该地点
    const point = new BMapGL.Point(site.location.lng, site.location.lat);
    map.panTo(point);
    map.setZoom(15);
}

// 筛选功能
document.querySelectorAll('.category-checkbox').forEach(checkbox => {
    checkbox.addEventListener('change', function() {
        const category = this.value;
        const isChecked = this.checked;
        
        // 在实际应用中，这里应该根据类别显示/隐藏对应的标记
        console.log(`类别 ${category} ${isChecked ? '显示' : '隐藏'}`);
    });
});

// 页面加载完成后初始化地图
window.onload = initMap;
</script>
</body>
</html>
